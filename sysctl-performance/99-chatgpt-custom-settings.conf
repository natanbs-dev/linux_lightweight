# === chatgpt settings sysctl ===

# --- Memória / I/O de discos ---

# Quanto menor, menos o sistema vai usar swap, mantendo tudo em RAM o máximo possível
vm.swappiness = 5

# Tensão de purga do cache de inodes/dentry: menos agressivo = melhor reutilização
vm.vfs_cache_pressure = 50

# Quando começar a escrever páginas sujas em background (% da RAM)
vm.dirty_background_ratio = 5

# Ponto em que o kernel bloqueia para gravar páginas sujas (% da RAM)
vm.dirty_ratio = 15

# Reservar memória livre, para evitar que o sistema fique sem memória disponível
# Ajustar para cerca de 1-2% da RAM, ou um valor absoluto que faça sentido
vm.min_free_kbytes = 65536

# Desativar zone reclaim, já que não é NUMA multicore com múltiplas zonas grandes
vm.zone_reclaim_mode = 0

# (Opcional) Ajustes de tempo para flushing — útil em NVMe de alta performance
vm.dirty_expire_centisecs = 2000
vm.dirty_writeback_centisecs = 500

# --- Agendador / Responsividade ---

# melhorar agrupamento interativo
kernel.sched_autogroup_enabled = 1

# Granularidades – tentar responsividade sem penalizar throughput demais
kernel.sched_min_granularity_ns = 4000000
kernel.sched_wakeup_granularity_ns = 5000000

# (Opcional) Ajustar latência / latência de interrupções etc
# Se kernel permitir: configurar HZ ou tickless etc via bootloader (ex: nohz_full) — mas isto é mais avançado

# --- Rede — throughput + latência interativa ---

net.core.default_qdisc = fq
net.ipv4.tcp_congestion_control = bbr
net.ipv4.tcp_fastopen = 3
net.core.netdev_max_backlog = 5000

# --- Segurança básica útil ---

kernel.kptr_restrict = 1
kernel.yama.ptrace_scope = 1

# --- Sistema de arquivos / Desenvolvimento / Monitoramento ---

fs.inotify.max_user_watches = 524288

# --- CPU / Governor / Frequência ---

# Essas não são puramente sysctl, mas importantes:

# Usar o governor que favorece performance ou híbrido (se disponível)
# Ex: intel_pstate ou “performance” ou “schedutil” dependendo da distro

# Se houver energia e configurações de BIOS:
# - Turbo ativado
# - Desligar modos de economia que atrasem escalonamento de frequência (C-states muito profundos)
# - Ajustes de “power profile” no Linux como “performance” quando ligado na tomada

